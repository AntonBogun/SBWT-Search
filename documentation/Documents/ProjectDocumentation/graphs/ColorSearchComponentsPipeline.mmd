flowchart TD
    subgraph "Main Memory (RAM)"
        IndexesBatch(["
            IndexesBatch
            <i>
            indexes (max_idxs * 64)
            </i>
        "])
        ColorsIntervalBatch(["
            ColorsIntervalBatch
            <i>
            warps_before_new_read (max_reads * 64)
            reads_before_newfile (max_reads * 64)
            </i>
        "])
        WarpsBeforeNewReadBatch(["
            WarpsBeforeNewReadBatch
            <i>
            warps_before_new_read (shared with ColorsIntervalBatch)
            </i>
        "])
        ReadStatisticsBatch(["
            ReadStatisticsBatch
            <i>
            found_indexes (max_reads * 64)
            invalid (max_reads * 64)
            not_found (max_reads * 64)
            </i>
        "])
        ColorSearchResultsBatch(["
            ColorSearchResultsBatch
            <i>
            results (max_idxs / warp_size * colors * 64)
            </i>
        "])
        ColorSearchResultsPostProcessedBatch(["
            ColorSearchResultsBatch
            <i>
            results (shared with ColorSearchResultsBath)
            </i>
        "])
        ColorsPrintBatch(["
            ColorsPrintBatch
            <i>
            results ((20 + 1) * 8 * max_reads * num_colors)
            </i>
        "])
        ColorSearchResultsPostProcessor
        ColorResultsPrinter

        subgraph IndexFileParser
            IndexesBatchProducer
            ColorsIntervalBatchProducer
            WarpsBeforeNewReadBatchProducer
            ReadStatisticsBatchProducer
        end
    end

    subgraph "Gpu Memory (VRAM)"
        ColorSearcher
    end

    subgraph Disk
        Indexes{Indexes}
        Colors{Colors}
    end

    Indexes --> IndexFileParser

    IndexesBatchProducer --- IndexesBatch
    ColorsIntervalBatchProducer --- ColorsIntervalBatch
    WarpsBeforeNewReadBatchProducer --- WarpsBeforeNewReadBatch
    ReadStatisticsBatchProducer --- ReadStatisticsBatch
    ColorSearchResultsPostProcessor --- ColorSearchResultsPostProcessedBatch
    ColorSearcher --- ColorSearchResultsBatch

    IndexesBatch --> ColorSearcher
    ColorsIntervalBatch --> ColorResultsPrinter
    WarpsBeforeNewReadBatch --> ColorSearchResultsPostProcessor
    ColorSearchResultsBatch --> ColorSearchResultsPostProcessor

    ReadStatisticsBatch --> ColorResultsPrinter
    ColorSearchResultsPostProcessedBatch --> ColorResultsPrinter

    ColorResultsPrinter --- ColorsPrintBatch
    ColorsPrintBatch --> Colors
